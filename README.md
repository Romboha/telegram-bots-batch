# Система Telegram Ботів для n8n

Цей проект містить код для створення групи Telegram ботів, що працюють з n8n для обробки повідомлень та автоматизації взаємодії.

## Огляд

Система дозволяє легко налаштувати та запустити кілька Telegram ботів одночасно. Повідомлення, отримані ботами, передаються до n8n через вебхуки для подальшої обробки. Боти інтегруються з наданими воркфлоу n8n для побудови системи RAG (Retrieval-Augmented Generation) AI Agent.

## Особливості

- Одночасна робота декількох ботів з єдиною системою керування
- Інтеграція з n8n через вебхуки
- Підтримка розпізнавання імен ботів у різних формах
- Можливість випадкової відповіді навіть якщо бота не згадували
- Можливість використання тестового та продакшн середовищ n8n
- Готові воркфлоу n8n для швидкого старту AI системи

## Вимоги

- Node.js 16+
- Telegram Bot API токени
- n8n, встановлений і налаштований для обробки вебхуків

## Встановлення

1. Клонуйте репозиторій:

```bash
git clone https://github.com/your-username/telegram-bots-batch.git
cd telegram-bots-batch
```

2. Встановіть залежності:

```bash
npm install
```

3. Скопіюйте `.env.example` у `.env` і налаштуйте відповідні значення.

4. Створіть файл конфігурації для вашого бота у папці `bots_configs` на основі `example_bot.js`.

## Структура проекту

```
├── api/                      # API інтеграції
│   └── n8n-api.js            # Модуль для взаємодії з n8n
├── bots_configs/             # Конфігурації ботів
│   └── example_bot.js        # Приклад конфігурації бота
├── data/                     # Каталог для зберігання даних ботів
│   └── example-bot-temp-files/ # Тимчасові файли бота
├── handlers/                 # Обробники подій
│   ├── bot-handlers.js       # Обробники повідомлень
│   └── bot-lifecycle.js      # Керування життєвим циклом ботів
├── utils/                    # Допоміжні функції
│   ├── bot-name-detector.js   # Визначення імен ботів
│   ├── message-analyzer.js    # Аналіз повідомлень
│   ├── multi-bot-detector.js  # Визначення кількох ботів
│   └── quotes-handler.js      # Обробка цитат
├── workflows/                # Воркфлоу для n8n
│   └── RAG_AI_Agent_Workflow.json # Воркфлоу AI агента з RAG
├── .env.example              # Приклад файлу змінних середовища
├── .gitignore                # Ігноровані файли для Git
├── bot-dispatcher.js         # Диспетчер ботів
├── global-config.js          # Глобальна конфігурація
├── index.js                  # Точка входу в програму
├── package.json              # Метадані проекту та залежності
├── README.md                 # Документація проекту
├── start-bots.sh             # Скрипт для запуску ботів
└── TASK_PLAN.md              # План розвитку проекту
```

## Конфігурація ботів

Кожен бот має свій конфігураційний файл у папці `bots_configs`. Приклад:

```javascript
module.exports = {
  id: 'my_bot',                // Унікальний ідентифікатор бота
  name: 'Мій Бот',             // Ім'я бота
  token: 'BOT_TOKEN_HERE',     // Токен Telegram бота
  webhookUrl: 'URL_HERE',      // URL вебхука для n8n
  nameVariations: ['Мій Бот', 'Мій', 'Ботик'], // Варіанти імен для розпізнавання
  randomResponseProbability: 0.1,  // Ймовірність випадкової відповіді
  tempFilesDir: './data/my-bot-temp-files', // Каталог для тимчасових файлів
  productionWebhookUrl: 'PROD_URL_HERE', // Продакшн URL вебхука
  testWebhookUrl: 'TEST_URL_HERE'        // Тестовий URL вебхука
};
```

## Використання

Запустіть систему ботів за допомогою скрипта:

```bash
./start-bots.sh
```

Або напряму через Node.js:

```bash
node index.js
```

## Інтеграція з n8n

Для інтеграції з n8n налаштуйте вебхуки в n8n, які будуть отримувати дані від ботів. Конфігурацію вебхуків можна вказати в файлах конфігурації ботів.

### Важлива примітка щодо воркфлоу RAG AI

Для роботи з воркфлоу RAG AI Agent необхідно обов'язково підключити до нього зовнішню або локальну модель ШІ. Приклади моделей, які можна підключити:

- OpenAI API (GPT-3.5/GPT-4)
- Anthropic Claude
- Ollama (локальні моделі на вашому сервері)
- LLaMA-based моделі через API

Без налаштування моделі ШІ воркфлоу не зможе обробляти запити користувачів.

## Ліцензія

MIT
